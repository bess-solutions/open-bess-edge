# =============================================================================
# BESSAI Edge Gateway — Python Dependencies (pinned)
# Python >= 3.10  (tested on 3.14)
# =============================================================================

# ---------------------------------------------------------------------------
# Async runtime (stdlib — no install needed, listed for documentation)
# asyncio is part of the Python standard library since 3.4
# ---------------------------------------------------------------------------

# ---------------------------------------------------------------------------
# Industrial Protocol — Modbus
# ---------------------------------------------------------------------------
pymodbus>=3.7.0

# ---------------------------------------------------------------------------
# Data validation & settings management
# ---------------------------------------------------------------------------
pydantic>=2.9.0
pydantic-settings>=2.5.0

# ---------------------------------------------------------------------------
# Observability — OpenTelemetry
# ---------------------------------------------------------------------------
opentelemetry-api>=1.27.0
opentelemetry-sdk>=1.27.0
opentelemetry-exporter-otlp>=1.27.0
opentelemetry-exporter-otlp-proto-grpc>=1.27.0
opentelemetry-instrumentation>=0.48b0

# ---------------------------------------------------------------------------
# Cloud Messaging — GCP Pub/Sub (async)
# ---------------------------------------------------------------------------
gcloud-aio-pubsub>=6.1.0

# ---------------------------------------------------------------------------
# Utilities
# ---------------------------------------------------------------------------
# YAML configuration parsing
PyYAML>=6.0.1
# Structured logging
structlog>=24.1.0
# HTTP client (async, for REST interfaces)
httpx>=0.27.0
# Retry logic
tenacity>=8.3.0

# ---------------------------------------------------------------------------
# Observability — Prometheus metrics exposition
# ---------------------------------------------------------------------------
prometheus_client>=0.20.0

# ---------------------------------------------------------------------------
# HTTP server — Health check & metrics endpoint
# ---------------------------------------------------------------------------
aiohttp>=3.9.5

# ---------------------------------------------------------------------------
# Edge AI — AI-IDS (Modbus anomaly detection) + ONNX inference engine
# ---------------------------------------------------------------------------
# Numerical computing (required by scikit-learn and onnxruntime)
numpy>=1.26.0
# IsolationForest for Modbus anomaly detection (AI-IDS)
scikit-learn>=1.4.0
# ONNX Runtime for offline dispatch policy inference
onnxruntime>=1.18.0

# ---------------------------------------------------------------------------
# v0.7.0 — Reinforcement Learning simulation
# ---------------------------------------------------------------------------
# Gymnasium environment (BESSEnv) — for local simulation & RL training only
gymnasium>=0.29.0

# ---------------------------------------------------------------------------
# v0.7.0 — Federated Learning client
# ---------------------------------------------------------------------------
# Flower FL framework (client runs on edge, server in aggregation tier)
flwr>=1.8.0

# ---------------------------------------------------------------------------
# v0.8.0 — DataLake Publisher (optional — falls back to JSONL without it)
# ---------------------------------------------------------------------------
# GCP BigQuery streaming inserts
# Uncomment for cloud deployment (adds ~200MB to image):
# google-cloud-bigquery>=3.19.0

# ---------------------------------------------------------------------------
# v0.9.0 — Dashboard REST API (already covered by aiohttp above)
# ---------------------------------------------------------------------------
# No new deps — dashboard_api.py reuses aiohttp installed above

# ---------------------------------------------------------------------------
# v1.7.0 — MQTT Publisher (universal IoT transport, optional)
# ---------------------------------------------------------------------------
# Install to enable MQTT publishing to Mosquitto, Home Assistant, AWS IoT Core,
# Azure IoT Hub, or any standard MQTT broker.
# If not installed, the gateway falls back gracefully to GCP Pub/Sub only.
paho-mqtt>=2.0.0

# ---------------------------------------------------------------------------
# Security — pin explícito para forzar version segura de dep. transitiva
# cryptography>=46.0.0 resuelve CVE detectado en v44.0.0 (pip-audit)
# Referencias: dependencia transitiva de paho-mqtt / gcloud-aio-pubsub
# ---------------------------------------------------------------------------
cryptography>=46.0.0

